using UnityEngine;

[CreateAssetMenu(fileName = "DarkInvulnerabilityPowerUp", menuName = "PowerUps/Dark Invulnerability")]
public class DarkInvulnerabilityPowerUp : PowerUp
{
    [Header("Configuraci√≥n")]
    public float activationHealthThreshold = 2f;
    public float invulnerabilityDuration = 3f;

    [Header("Visual (opcional)")]
    public GameObject shieldVfxPrefab;

    public override void Apply(PlayerController player)
    {
        if (player == null) return;

        var darkPower = player.GetComponent<DarkInvulnerabilityPower>();
        if (darkPower == null)
            darkPower = player.gameObject.AddComponent<DarkInvulnerabilityPower>();

        darkPower.activationHealthThreshold = activationHealthThreshold;
        darkPower.invulnerabilityDuration = invulnerabilityDuration;

        darkPower.shieldVfxPrefab = shieldVfxPrefab;

        darkPower.ActivatePower();
        darkPower.enabled = true;
    }

    public override void Remove(PlayerController player)
    {
        var darkPower = player.GetComponent<DarkInvulnerabilityPower>();
        if (darkPower != null)
        {
            darkPower.DeactivatePower();
            darkPower.enabled = false;
        }
    }
}